(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8520:function(e,l,s){Promise.resolve().then(s.bind(s,7038))},7038:function(e,l,s){"use strict";s.r(l),s.d(l,{default:function(){return eN}});var t=s(5444),a=s(9300),r=s(2191),i=s(3607);function n(...e){return(0,i.m6)((0,r.W)(e))}let c=a.forwardRef(({className:e,...l},s)=>(0,t.jsx)("div",{ref:s,className:n("panda-card",e),...l}));c.displayName="Card";let d=a.forwardRef(({className:e,...l},s)=>(0,t.jsx)("div",{ref:s,className:n("flex flex-col space-y-1.5 p-6",e),...l}));d.displayName="CardHeader";let o=a.forwardRef(({className:e,...l},s)=>(0,t.jsx)("h3",{ref:s,className:n("text-2xl font-semibold leading-none tracking-tight font-heading",e),...l}));o.displayName="CardTitle",a.forwardRef(({className:e,...l},s)=>(0,t.jsx)("p",{ref:s,className:n("text-sm text-muted-foreground",e),...l})).displayName="CardDescription";let u=a.forwardRef(({className:e,...l},s)=>(0,t.jsx)("div",{ref:s,className:n("p-6 pt-0",e),...l}));u.displayName="CardContent",a.forwardRef(({className:e,...l},s)=>(0,t.jsx)("div",{ref:s,className:n("flex items-center p-6 pt-0",e),...l})).displayName="CardFooter";var m=s(223),x=s(2371);let p=(0,x.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",panda:"panda-button"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=a.forwardRef(({className:e,variant:l,size:s,asChild:a=!1,...r},i)=>{let c=a?m.g7:"button";return(0,t.jsx)(c,{className:n(p({variant:l,size:s,className:e})),ref:i,...r})});h.displayName="Button";let f=a.forwardRef(({className:e,type:l,...s},a)=>(0,t.jsx)("input",{type:l,className:n("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));f.displayName="Input";let g=(0,x.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function y({className:e,variant:l,...s}){return(0,t.jsx)("div",{className:n(g({variant:l}),e),...s})}var j=s(4624),N=s(8752),b=s(8274),v=s(9429),w=s(9211),E=s(3594),C=s(9062),S=s(101);let D={YELLOW:[1,2,3,4,5,6],PURPLE:[1,2,3,4,5,6,7,8,9,10,11,12],BLUE:[1,2,3,4,5,6,7,8,9,10,11,12],BLUE_GLITTER:[1,2,3,4,5,6],RED:[-4,-3,-2,-1,0,1,2,3,4,5,6,7,8],GREEN:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],CLEAR:[1,2,3,4,5,6],PINK:[1,2,3,4,5,6,7,8,9,10,11,12]};function R(e){return e>=2&&e<=3?1:e>=4&&e<=6?2:e>=7&&e<=9?3:10===e?4:1}let T="panda_royale_game";function L(e){try{localStorage.setItem(T,JSON.stringify(e))}catch(e){console.error("Failed to save game to localStorage:",e)}}function k(){try{let e=localStorage.getItem(T);if(!e)return null;let l=JSON.parse(e);return l.createdAt=new Date(l.createdAt),l}catch(e){return console.error("Failed to load game from localStorage:",e),null}}function P(e){let{diceType:l,diceCount:s,diceValues:t,hasGlitterDie:a=!1}=e;if(0===t.length)return{diceType:l,rawScore:0,multiplier:1,finalScore:0,description:"No dice rolled"};let r=t.reduce((e,l)=>e+l,0);switch(l){case"YELLOW":return{diceType:l,rawScore:r,multiplier:1,finalScore:r,description:`Yellow dice: ${t.join(" + ")} = ${r} points`};case"PURPLE":return{diceType:l,rawScore:r,multiplier:2,finalScore:2*r,description:`Purple dice: (${t.join(" + ")}) \xd7 2 = ${2*r} points`};case"BLUE":let i=a?2:1,n=r*i;return{diceType:l,rawScore:r,multiplier:i,finalScore:n,description:a?`Blue dice with Glitter: (${t.join(" + ")}) \xd7 2 = ${n} points`:`Blue dice: ${t.join(" + ")} = ${n} points`};case"BLUE_GLITTER":let c=2*r;return{diceType:l,rawScore:r,multiplier:2,finalScore:c,description:`Blue Glitter dice: (${t.join(" + ")}) \xd7 2 = ${c} points`};case"RED":let d=r*s;return{diceType:l,rawScore:r,multiplier:s,finalScore:d,description:`Red dice: (${t.join(" + ")}) \xd7 ${s} dice = ${d} points`};case"GREEN":case"CLEAR":case"PINK":return{diceType:l,rawScore:r,multiplier:1,finalScore:r,description:`${l.toLowerCase()} dice: ${t.join(" + ")} = ${r} points`};default:return{diceType:l,rawScore:0,multiplier:1,finalScore:0,description:"Unknown dice type"}}}function I(e){if(e.diceCount<0)return{valid:!1,error:"Dice count cannot be negative"};if(e.diceValues.length!==e.diceCount)return{valid:!1,error:"Number of dice values must match dice count"};let l=D[e.diceType];return e.diceValues.filter(e=>!l.includes(e)).length>0?{valid:!1,error:`${e.diceType} dice values must be between ${Math.min(...l)} and ${Math.max(...l)}${"RED"===e.diceType?" (including negative values)":""}`}:{valid:!0}}function G(e){return Math.max(...D[e])}function _(e,l){switch(l){case"YELLOW":return e.diceCollection.yellow;case"PURPLE":return e.diceCollection.purple;case"BLUE":return e.diceCollection.blue;case"BLUE_GLITTER":return e.diceCollection.blueGlitter;case"RED":return e.diceCollection.red;case"GREEN":return e.diceCollection.green;case"CLEAR":return e.diceCollection.clear;case"PINK":return e.diceCollection.pink;default:return 0}}function U(e,l,s){let t={...e.diceCollection},a=Math.max(0,s);switch(l){case"YELLOW":t.yellow=a;break;case"PURPLE":t.purple=a;break;case"BLUE":t.blue=a;break;case"BLUE_GLITTER":t.blueGlitter=a;break;case"RED":t.red=a;break;case"GREEN":t.green=a;break;case"CLEAR":t.clear=a;break;case"PINK":t.pink=a}return{...e,diceCollection:t}}function A(e,l,s){return 0===e.diceCollection.clear?{canTrade:!1,error:"No clear dice available to trade"}:"PINK"===s?{canTrade:!1,error:"Cannot trade for pink dice"}:0===_(l,s)?{canTrade:!1,error:`Target player has no ${s.toLowerCase()} dice to trade`}:{canTrade:!0}}function B(e){return e.currentRound>10||"FINISHED"===e.status}function $(e){return 0===e.length?null:[...e].sort((e,l)=>l.totalScore-e.totalScore)[0]||null}function O(e){return({YELLOW:"\uD83D\uDFE1",PURPLE:"\uD83D\uDFE3",BLUE:"\uD83D\uDD35",BLUE_GLITTER:"✨",RED:"\uD83D\uDD34",GREEN:"\uD83D\uDFE2",CLEAR:"⚪",PINK:"\uD83C\uDF38"})[e]||"⚫"}function F(e,l){let s=e.currentRound-1;return!(s<0)&&!(s>=e.roundScores.length)&&e.roundScores[s].some(e=>e.playerId===l)}function Y(e){let l=e.currentRound-1;return e.roundScores[l]||[]}var Z=s(9362),V=s(3485);let M=Z.fC;Z.xz;let W=Z.h_;Z.x8;let z=a.forwardRef(({className:e,...l},s)=>(0,t.jsx)(Z.aV,{ref:s,className:n("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...l}));z.displayName=Z.aV.displayName;let H=a.forwardRef(({className:e,children:l,...s},a)=>(0,t.jsxs)(W,{children:[(0,t.jsx)(z,{}),(0,t.jsxs)(Z.VY,{ref:a,className:n("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[l,(0,t.jsxs)(Z.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(V.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));H.displayName=Z.VY.displayName;let K=({className:e,...l})=>(0,t.jsx)("div",{className:n("flex flex-col space-y-1.5 text-center sm:text-left",e),...l});K.displayName="DialogHeader";let q=({className:e,...l})=>(0,t.jsx)("div",{className:n("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...l});q.displayName="DialogFooter";let J=a.forwardRef(({className:e,...l},s)=>(0,t.jsx)(Z.Dx,{ref:s,className:n("text-lg font-semibold leading-none tracking-tight font-heading",e),...l}));function Q({diceType:e,selectedValues:l,onValueSelect:s,onValueDeselect:a,maxSelections:r,className:i}){let c=D[e]||[1,2,3,4,5,6],d=e=>{let t=l.filter(l=>l===e).length,i=l.length;t>0?a(e):i<r&&s(e)},o=e=>l.filter(l=>l===e).length,u=e=>{let s=o(e),t=l.length;return s>0||t<r};return(0,t.jsxs)("div",{className:n("space-y-3",i),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)("div",{className:`dice-indicator dice-${e.toLowerCase().replace("_","-")} w-6 h-6 text-sm`,children:O(e)}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:["Select ",r," ",e.replace("_"," ").toLowerCase()," dice values:"]}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",l.length,"/",r," selected)"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-4 sm:grid-cols-6 lg:grid-cols-8 gap-2",children:c.map(l=>{let s=o(l),a=u(l),r=s>0;return(0,t.jsxs)(h,{variant:r?"default":"outline",size:"sm",onClick:()=>d(l),disabled:!a,className:n("relative h-12 w-12 flex flex-col items-center justify-center text-xs font-bold transition-all duration-200","RED"===e&&l<0&&"text-red-600 border-red-300","RED"===e&&0===l&&"text-yellow-600 border-yellow-300","RED"===e&&l>0&&"text-green-600 border-green-300",r&&"ring-2 ring-primary ring-offset-1",!a&&"opacity-50 cursor-not-allowed"),children:[(0,t.jsx)("span",{className:n("leading-none","RED"===e&&l<0&&"text-red-700","RED"===e&&0===l&&"text-yellow-700","RED"===e&&l>0&&"text-green-700"),children:l}),s>0&&(0,t.jsx)(y,{variant:"secondary",className:"absolute -top-1 -right-1 h-5 w-5 text-xs p-0 flex items-center justify-center",children:s})]},l)})}),"RED"===e&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground p-2 bg-muted/50 rounded",children:[(0,t.jsx)("span",{className:"font-medium",children:"Red dice:"})," Can have negative, zero, or positive values. Score = (sum of values) \xd7 (number of dice)"]}),l.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-1 p-2 bg-primary/5 rounded",children:[(0,t.jsx)("span",{className:"text-xs font-medium",children:"Selected values:"}),l.map((l,s)=>(0,t.jsx)(y,{variant:"secondary",className:n("text-xs cursor-pointer hover:bg-destructive hover:text-destructive-foreground","RED"===e&&l<0&&"bg-red-100 text-red-700","RED"===e&&0===l&&"bg-yellow-100 text-yellow-700","RED"===e&&l>0&&"bg-green-100 text-green-700"),onClick:()=>a(l),title:"Click to remove",children:l},s))]})]})}J.displayName=Z.Dx.displayName,a.forwardRef(({className:e,...l},s)=>(0,t.jsx)(Z.dk,{ref:s,className:n("text-sm text-muted-foreground",e),...l})).displayName=Z.dk.displayName;var X=s(3492);let ee=[{type:"YELLOW",label:"Yellow"},{type:"PURPLE",label:"Purple"},{type:"BLUE",label:"Blue"},{type:"BLUE_GLITTER",label:"Blue Glitter"},{type:"RED",label:"Red"},{type:"GREEN",label:"Green"},{type:"CLEAR",label:"Clear"},{type:"PINK",label:"Pink"}];function el({open:e,onClose:l,onSubmit:s,player:r}){let[i,n]=(0,a.useState)("YELLOW"),[c,d]=(0,a.useState)([]),[o,u]=(0,a.useState)({diceType:"YELLOW",diceCount:0,diceValues:[],hasGlitterDie:!1,calculatedScore:0}),m=_(r,i);G(i);let x=e=>{u(l=>({...l,...e}))},p=e=>{d(c.filter(l=>l.diceType!==e))},g=()=>{d([]),u({diceType:"YELLOW",diceCount:0,diceValues:[],hasGlitterDie:!1,calculatedScore:0}),l()},j=e=>{n(e);let l=c.find(l=>l.diceType===e);l?u(l):u({diceType:e,diceCount:0,diceValues:[],hasGlitterDie:!1,calculatedScore:0})},N=c.reduce((e,l)=>e+l.calculatedScore,0),b=o.diceCount>0&&o.diceValues.length===o.diceCount?P(o).finalScore:0;return(0,t.jsx)(M,{open:e,onOpenChange:g,children:(0,t.jsxs)(H,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(K,{children:(0,t.jsxs)(J,{className:"flex items-center gap-2",children:["\uD83C\uDFB2 Enter Your Dice Scores",(0,t.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:["(",r.name,")"]})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium mb-3",children:"Select Dice Type:"}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:ee.map(({type:e,label:l})=>{let s=_(r,e);return(0,t.jsxs)(h,{variant:i===e?"default":"outline",onClick:()=>j(e),disabled:0===s,className:"h-auto flex flex-col gap-1 p-3",children:[(0,t.jsx)("div",{className:`dice-indicator dice-${e.toLowerCase().replace("_","-")} w-6 h-6 text-sm`,children:O(e)}),(0,t.jsx)("span",{className:"text-xs",children:l}),(0,t.jsx)(y,{variant:"secondary",className:"text-xs",children:s})]},e)})})]}),m>0&&(0,t.jsxs)("div",{className:"panda-card bg-secondary/20",children:[(0,t.jsxs)("h3",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,t.jsx)("div",{className:`dice-indicator dice-${i.toLowerCase().replace("_","-")} w-6 h-6 text-sm`,children:O(i)}),"Configure ",i.replace("_"," ").toLowerCase()," dice (max: ",m,")"]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["How many ",i.replace("_"," ").toLowerCase()," dice are you rolling?"]}),(0,t.jsx)(f,{type:"number",min:"0",max:m,value:o.diceCount,onChange:e=>{let l=parseInt(e.target.value)||0;x({diceCount:l,diceValues:o.diceValues.slice(0,l)})},className:"w-32"})]}),o.diceCount>0&&(0,t.jsx)(Q,{diceType:i,selectedValues:o.diceValues,onValueSelect:e=>{x({diceValues:[...o.diceValues,e]})},onValueDeselect:e=>{let l=o.diceValues.indexOf(e);if(-1!==l){let e=[...o.diceValues];e.splice(l,1),x({diceValues:e})}},maxSelections:o.diceCount,className:"mt-4"}),"BLUE"===i&&o.diceCount>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"glitter-die",checked:o.hasGlitterDie,onChange:e=>x({hasGlitterDie:e.target.checked}),className:"rounded"}),(0,t.jsxs)("label",{htmlFor:"glitter-die",className:"text-sm font-medium flex items-center gap-1",children:[(0,t.jsx)(X.Z,{className:"w-4 h-4"}),"Glitter Die Rolled? (doubles the score)"]})]}),b>0&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Preview: ",P(o).description]}),o.diceCount>0&&o.diceValues.length===o.diceCount&&(0,t.jsx)(h,{onClick:()=>{let e=I(o);if(!e.valid){alert(e.error);return}let l=P(o),s={diceType:o.diceType,diceCount:o.diceCount,diceValues:o.diceValues,hasGlitterDie:o.hasGlitterDie||!1,calculatedScore:l.finalScore},t=c.findIndex(e=>e.diceType===o.diceType);if(t>=0){let e=[...c];e[t]=s,d(e)}else d([...c,s]);u({diceType:i,diceCount:0,diceValues:[],hasGlitterDie:!1,calculatedScore:0})},variant:"secondary",size:"sm",children:"Add This Entry"})]})]}),c.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium mb-3",children:"Your Scores:"}),(0,t.jsx)("div",{className:"space-y-2",children:c.map(e=>{let l=P(e);return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`dice-indicator dice-${e.diceType.toLowerCase().replace("_","-")} w-6 h-6 text-sm`,children:O(e.diceType)}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:e.diceType.replace("_"," ")}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:l.description})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"font-bold text-primary",children:["+",e.calculatedScore]}),(0,t.jsx)(h,{variant:"ghost",size:"sm",onClick:()=>p(e.diceType),children:"Remove"})]})]},e.diceType)})})]}),(c.length>0||b>0)&&(0,t.jsx)("div",{className:"panda-card bg-primary/10 border-primary/30",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Round Total:"}),(0,t.jsx)("div",{className:"score-counter text-2xl text-primary",children:N+b})]})})]}),(0,t.jsxs)(q,{children:[(0,t.jsx)(h,{variant:"outline",onClick:g,children:"Cancel"}),(0,t.jsx)(h,{onClick:()=>{let e=[...c];if(o.diceCount>0&&o.diceValues.length===o.diceCount&&I(o).valid){let l=P(o),s={diceType:o.diceType,diceCount:o.diceCount,diceValues:o.diceValues,hasGlitterDie:o.hasGlitterDie||!1,calculatedScore:l.finalScore},t=e.findIndex(e=>e.diceType===o.diceType);t>=0?e[t]=s:e.push(s)}s(e),g()},disabled:0===c.length&&0===o.diceCount,children:"Submit Scores"})]})]})})}let es=[{type:"YELLOW",label:"Yellow",color:"dice-yellow"},{type:"PURPLE",label:"Purple",color:"dice-purple"},{type:"BLUE",label:"Blue",color:"dice-blue"},{type:"BLUE_GLITTER",label:"Blue Glitter",color:"dice-blue"},{type:"RED",label:"Red",color:"dice-red"},{type:"GREEN",label:"Green",color:"dice-green"},{type:"CLEAR",label:"Clear",color:"dice-clear"},{type:"PINK",label:"Pink",color:"dice-pink"}];function et({player:e,onUpdateDiceCount:l,disabled:s=!1,showControls:a=!0}){let r=l=>{switch(l){case"YELLOW":return e.diceCollection.yellow;case"PURPLE":return e.diceCollection.purple;case"BLUE":return e.diceCollection.blue;case"BLUE_GLITTER":return e.diceCollection.blueGlitter;case"RED":return e.diceCollection.red;case"GREEN":return e.diceCollection.green;case"CLEAR":return e.diceCollection.clear;case"PINK":return e.diceCollection.pink;default:return 0}},i=s=>{let t=r(s);l(e.id,s,t+1)},n=s=>{let t=r(s);t>0&&l(e.id,s,t-1)},m=Object.values(e.diceCollection).reduce((e,l)=>e+l,0);return(0,t.jsxs)(c,{className:"w-full",children:[(0,t.jsx)(d,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(o,{className:"text-lg font-semibold",children:[e.name,e.hasPandaToken&&(0,t.jsx)(y,{variant:"outline",className:"ml-2 bg-yellow-100 text-yellow-800",children:"\uD83D\uDC3C Panda Token"})]}),(0,t.jsxs)(y,{variant:"secondary",className:"text-sm",children:["Total: ",m," dice"]})]})}),(0,t.jsx)(u,{children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:es.map(({type:e,label:l,color:c})=>{let d=r(e);return(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,t.jsx)("div",{className:`dice-indicator ${c} w-8 h-8 text-lg`,children:O(e)}),(0,t.jsx)("span",{className:"text-xs font-medium text-center",children:l}),a?(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(h,{variant:"outline",size:"sm",className:"h-6 w-6 p-0",onClick:()=>n(e),disabled:s||0===d,children:(0,t.jsx)(w.Z,{className:"h-3 w-3"})}),(0,t.jsx)("span",{className:"min-w-[24px] text-center font-semibold",children:d}),(0,t.jsx)(h,{variant:"outline",size:"sm",className:"h-6 w-6 p-0",onClick:()=>i(e),disabled:s,children:(0,t.jsx)(v.Z,{className:"h-3 w-3"})})]}):(0,t.jsx)(y,{variant:"outline",className:"text-xs",children:d})]},e)})})})]})}var ea=s(9032),er=s(4693);function ei({label:e,players:l,selectedPlayerId:s,onPlayerSelect:a,excludePlayerIds:r=[],disabled:i=!1,allowNone:c=!0,className:d}){let o=l.filter(e=>!r.includes(e.id)),u=e=>{s===e?a(c?null:e):a(e)};return(0,t.jsxs)("div",{className:n("space-y-3",d),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(er.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e,":"]}),s&&(0,t.jsx)(y,{variant:"secondary",className:"text-xs",children:l.find(e=>e.id===s)?.name})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[c&&(0,t.jsx)(h,{variant:null===s?"default":"outline",size:"sm",onClick:()=>u(null),disabled:i,className:"h-12 flex items-center justify-center text-sm transition-all duration-200",children:"None"}),o.map(e=>{let l=s===e.id;return(0,t.jsxs)(h,{variant:l?"default":"outline",size:"sm",onClick:()=>u(e.id),disabled:i,className:n("h-12 flex items-center justify-center gap-2 text-sm transition-all duration-200",l&&"ring-2 ring-primary ring-offset-1"),children:[(0,t.jsx)("span",{children:e.name}),e.hasPandaToken&&(0,t.jsx)(C.Z,{className:"h-3 w-3 text-yellow-600"})]},e.id)})]}),s&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground text-center",children:["Click the selected player again to ",c?"deselect":"change selection"]})]})}var en=s(2984);function ec({label:e,availableDiceTypes:l,selectedDiceType:s,onDiceTypeSelect:a,disabled:r=!1,allowNone:i=!0,showCounts:c=!1,className:d}){let o=e=>{s===e?a(i?null:e):a(e)};return(0,t.jsxs)("div",{className:n("space-y-3",d),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(en.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e,":"]}),s&&(0,t.jsxs)(y,{variant:"secondary",className:"text-xs flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-sm",children:O(s)}),l.find(e=>e.type===s)?.label]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:[i&&(0,t.jsx)(h,{variant:null===s?"default":"outline",size:"sm",onClick:()=>o(null),disabled:r,className:"h-16 flex flex-col items-center justify-center text-xs transition-all duration-200",children:(0,t.jsx)("span",{children:"None"})}),l.map(e=>{let l=s===e.type;return(0,t.jsxs)(h,{variant:l?"default":"outline",size:"sm",onClick:()=>o(e.type),disabled:r,className:n("h-16 flex flex-col items-center justify-center gap-1 text-xs transition-all duration-200",l&&"ring-2 ring-primary ring-offset-1"),children:[(0,t.jsx)("div",{className:`dice-indicator dice-${e.type.toLowerCase().replace("_","-")} w-8 h-8 text-lg`,children:O(e.type)}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium",children:e.label}),c&&void 0!==e.count&&(0,t.jsx)(y,{variant:"secondary",className:"text-xs mt-1",children:e.count})]})]},e.type)})]}),s&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground text-center",children:["Click the selected dice type again to ",i?"deselect":"change selection"]})]})}function ed({players:e,currentPlayerId:l,onExecuteTrade:s,disabled:r=!1}){let[i,n]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),p=e.find(e=>e.id===l),f=e.find(e=>e.id===i),g=(0,a.useMemo)(()=>f?[{type:"YELLOW",label:"Yellow"},{type:"PURPLE",label:"Purple"},{type:"BLUE",label:"Blue"},{type:"BLUE_GLITTER",label:"Blue Glitter"},{type:"RED",label:"Red"},{type:"GREEN",label:"Green"},{type:"CLEAR",label:"Clear"}].filter(e=>{let l=f.diceCollection;switch(e.type){case"YELLOW":return l.yellow>0;case"PURPLE":return l.purple>0;case"BLUE":return l.blue>0;case"BLUE_GLITTER":return l.blueGlitter>0;case"RED":return l.red>0;case"GREEN":return l.green>0;case"CLEAR":return l.clear>0;default:return!1}}):[],[f]);if(!p||0===p.diceCollection.clear)return(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{children:(0,t.jsxs)(o,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Z,{className:"h-5 w-5"}),"Dice Trading"]})}),(0,t.jsx)(u,{children:(0,t.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:p?"No clear dice available for trading":"Player not found"})})]});let N=e.filter(e=>e.id!==l),b=f&&m?A(p,f,m):{canTrade:!1,error:i?"Select a dice type to trade for":"Select a target player"};return(0,t.jsxs)(c,{children:[(0,t.jsxs)(d,{children:[(0,t.jsxs)(o,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Z,{className:"h-5 w-5"}),"Dice Trading"]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Trade your clear dice for other dice types"})]}),(0,t.jsxs)(u,{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 text-sm",children:(0,t.jsxs)(y,{variant:"outline",className:"dice-clear",children:[O("CLEAR")," Clear dice: ",p.diceCollection.clear]})}),(0,t.jsx)(ei,{label:"Trade with player",players:N,selectedPlayerId:i,onPlayerSelect:e=>{n(e),x(null)},disabled:r,allowNone:!1}),i&&g.length>0&&(0,t.jsx)(ec,{label:"Request dice type",availableDiceTypes:g,selectedDiceType:m,onDiceTypeSelect:x,disabled:r,allowNone:!1}),i&&0===g.length&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-lg text-center",children:[f?.name," has no dice available for trading (excluding pink dice)"]}),i&&m&&(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 py-3 bg-muted rounded-lg",children:[(0,t.jsxs)(y,{variant:"outline",className:"dice-clear",children:[O("CLEAR")," Clear"]}),(0,t.jsx)(ea.Z,{className:"h-4 w-4"}),(0,t.jsxs)(y,{variant:"outline",className:`dice-${m.toLowerCase().replace("_","-")}`,children:[O(m)," ",m.replace("_"," ")]})]}),!b.canTrade&&b.error&&(0,t.jsx)("div",{className:"text-sm text-destructive bg-destructive/10 p-3 rounded",children:b.error}),(0,t.jsxs)(h,{onClick:()=>{b.canTrade&&i&&m&&(s(l,i,m),n(null),x(null))},disabled:r||!b.canTrade,className:"w-full",children:["Execute Trade",i&&m&&` (Clear → ${m.replace("_"," ")})`]})]})]})}var eo=s(1501),eu=s(6488),em=s(4761);function ex({label:e,selectedCount:l,maxCount:s,onCountSelect:a,disabled:r=!1,allowNone:i=!0,className:c}){let d=Array.from({length:s},(e,l)=>l+1),o=e=>{l===e?a(i?null:e):a(e)};return(0,t.jsxs)("div",{className:n("space-y-3",c),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(em.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e,":"]}),null!==l&&(0,t.jsxs)(y,{variant:"secondary",className:"text-xs",children:[l," selected"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-5 sm:grid-cols-8 lg:grid-cols-10 gap-2",children:[i&&(0,t.jsx)(h,{variant:null===l?"default":"outline",size:"sm",onClick:()=>o(null),disabled:r,className:"h-10 w-10 flex items-center justify-center text-xs font-bold transition-all duration-200",children:"None"}),d.map(e=>{let s=l===e;return(0,t.jsx)(h,{variant:s?"default":"outline",size:"sm",onClick:()=>o(e),disabled:r,className:n("h-10 w-10 flex items-center justify-center text-xs font-bold transition-all duration-200",s&&"ring-2 ring-primary ring-offset-1"),children:e},e)})]}),null!==l&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground text-center",children:["Click the selected number again to ",i?"deselect":"change selection"]})]})}function ep({diceBag:e,players:l,currentTurnPlayerId:s,onSelectDie:r,disabled:i=!1}){let[n,m]=(0,a.useState)(null),[x,p]=(0,a.useState)(null),f=l.find(e=>e.id===s);if(!f)return(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{children:(0,t.jsxs)(o,{className:"flex items-center gap-2",children:[(0,t.jsx)(eo.Z,{className:"h-5 w-5"}),"Dice Selection"]})}),(0,t.jsx)(u,{children:(0,t.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"Player not found"})})]});let g=[{type:"YELLOW",label:"Yellow",count:e.yellow},{type:"PURPLE",label:"Purple",count:e.purple},{type:"BLUE",label:"Blue",count:e.blue},{type:"BLUE_GLITTER",label:"Blue Glitter",count:e.blueGlitter},{type:"RED",label:"Red",count:e.red},{type:"GREEN",label:"Green",count:e.green},{type:"CLEAR",label:"Clear",count:e.clear}].filter(e=>e.count>0);return 0===g.length?(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{children:(0,t.jsxs)(o,{className:"flex items-center gap-2",children:[(0,t.jsx)(eo.Z,{className:"h-5 w-5"}),"Dice Selection Complete"]})}),(0,t.jsx)(u,{children:(0,t.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"No more dice available in the bag"})})]}):(0,t.jsxs)(c,{children:[(0,t.jsxs)(d,{children:[(0,t.jsxs)(o,{className:"flex items-center gap-2",children:[(0,t.jsx)(eo.Z,{className:"h-5 w-5"}),"Free Dice Selection"]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[f.name,"'s turn to select a die"]})]}),(0,t.jsxs)(u,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(C.Z,{className:"h-4 w-4 text-yellow-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Current Turn:"}),(0,t.jsxs)(y,{variant:f.hasPandaToken?"default":"secondary",children:[f.name,f.hasPandaToken&&" \uD83D\uDC3C"]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(ec,{label:"Choose any available dice color",availableDiceTypes:g,selectedDiceType:n,onDiceTypeSelect:m,disabled:i,allowNone:!1,showCounts:!0}),n&&(0,t.jsxs)("div",{className:"space-y-4 p-4 bg-muted/30 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eu.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Optional: Set maximum value"})]}),(0,t.jsx)(ex,{label:"Maximum value limit",selectedCount:x,maxCount:G(n),onCountSelect:p,disabled:i,allowNone:!0}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Setting a maximum value means your die will only have values from 1 to that maximum.",null===x&&" No limit means the full range is available."]})]}),n&&(0,t.jsxs)(h,{onClick:()=>{n&&(r(s,n,x||void 0),m(null),p(null))},disabled:i,className:"w-full",children:["Select ",n.replace("_"," ").toLowerCase()," die",x&&` (max ${x})`]})]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground text-center",children:"Selection order based on yellow dice scores (highest to lowest)"})]})]})}var eh=s(6886),ef=s(4907),eg=s(6124);let ey={ROLLING:{icon:eo.Z,title:"Rolling & Scoring",description:"Players roll dice and enter scores",nextPhase:"PITY_DICE",buttonText:"Distribute Pink Dice"},PITY_DICE:{icon:eh.Z,title:"Pink Dice Distribution",description:"Redistribute pink pity dice to lowest scoring players",nextPhase:"TRADING",buttonText:"Start Trading Phase"},TRADING:{icon:j.Z,title:"Dice Trading",description:"Players can trade dice using clear dice",nextPhase:"NEW_DICE",buttonText:"Select New Dice"},NEW_DICE:{icon:ef.Z,title:"New Dice Selection",description:"Players select new dice from the bag",nextPhase:"RESULTS",buttonText:"View Round Results"},RESULTS:{icon:b.Z,title:"Round Results",description:"Review round results and advance to next round",nextPhase:"ROLLING",buttonText:"Next Round"}};function ej({game:e,onAdvancePhase:l,canAdvance:s,disabled:a=!1}){if("SETUP"===e.phase||"GAME_COMPLETE"===e.phase)return null;let r=ey[e.phase];if(!r)return null;let{icon:i,title:n,description:m,nextPhase:x,buttonText:p}=r;return(0,t.jsxs)(c,{className:"bg-primary/5 border-primary/20",children:[(0,t.jsxs)(d,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i,{className:"h-5 w-5 text-primary"}),(0,t.jsx)(o,{className:"text-lg",children:n})]}),(0,t.jsxs)(y,{variant:"outline",className:"bg-primary/10 text-primary",children:["Round ",e.currentRound," of 10"]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:m})]}),(0,t.jsx)(u,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(eg.Z,{className:`h-4 w-4 ${s?"text-green-600":"text-gray-400"}`}),s?"Ready to advance":"Waiting for completion"]}),(0,t.jsxs)(h,{onClick:()=>{"RESULTS"===e.phase&&e.currentRound>=10?l("GAME_COMPLETE"):l(x)},disabled:a||!s,className:"flex items-center gap-2",children:[p,(0,t.jsx)(ea.Z,{className:"h-4 w-4"})]})]})})]})}function eN(){let[e,l]=(0,a.useState)("SETUP"),[s,r]=(0,a.useState)(["",""]),[i,n]=(0,a.useState)(null),[m,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null),[D,I]=(0,a.useState)(""),[G,O]=(0,a.useState)("");(0,a.useEffect)(()=>{if(function(){let e=k();return null!==e&&"FINISHED"!==e.status}()){let e=k();e&&(n(e),l("FINISHED"===e.status?"FINISHED":"PLAYING"))}},[]);let Z=R(s.filter(e=>e.trim()).length),V=e=>{s.length>2&&r(s.filter((l,s)=>s!==e))},M=(e,l)=>{let t=[...s];t[e]=l,r(t)},W=()=>{confirm("Are you sure you want to reset the game? All progress will be lost.")&&(!function(){try{localStorage.removeItem(T)}catch(e){console.error("Failed to clear game from localStorage:",e)}}(),n(null),l("SETUP"),r(["",""]),x(!1),g(null),I(""),O(""))},z=e=>{g(e),x(!0)},H=(e,l,s)=>{if(i)try{let t=i.players.find(l=>l.id===e);if(!t)return;let a=U(t,l,s),r={...i,players:i.players.map(l=>l.id===e?a:l)};n(r)}catch(e){alert(e instanceof Error?e.message:"Failed to update dice count")}};if("SETUP"===e)return(0,t.jsx)("div",{className:"min-h-screen purple-gradient-pattern flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"container-panda",children:(0,t.jsxs)("div",{className:"w-full max-w-2xl mx-auto space-y-8",children:[(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDC3C"}),(0,t.jsx)("h1",{className:"text-4xl font-bold font-heading text-balance",children:"Panda Royale"}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground text-balance",children:"Enhanced dice management with end-of-round mechanics"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[(0,t.jsxs)("div",{className:"panda-card py-6",children:[(0,t.jsx)(j.Z,{className:"w-8 h-8 mx-auto mb-2 text-primary"}),(0,t.jsx)("h3",{className:"font-semibold",children:"2-10 Players"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enhanced dice collections"})]}),(0,t.jsxs)("div",{className:"panda-card py-6",children:[(0,t.jsx)(N.Z,{className:"w-8 h-8 mx-auto mb-2 text-primary"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Multi-Phase Rounds"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Score, trade, select new dice"})]}),(0,t.jsxs)("div",{className:"panda-card py-6",children:[(0,t.jsx)(b.Z,{className:"w-8 h-8 mx-auto mb-2 text-primary"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Official Rules"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Complete rulebook implementation"})]})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{children:(0,t.jsxs)(o,{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Z,{className:"w-5 h-5"}),"Setup New Game"]})}),(0,t.jsxs)(u,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Player Names (",2,"-",10," players)"]}),(0,t.jsx)("div",{className:"space-y-2",children:s.map((e,l)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(f,{placeholder:`Player ${l+1}`,value:e,onChange:e=>M(l,e.target.value),className:"flex-1"}),l>=2&&(0,t.jsx)(h,{variant:"outline",size:"icon",onClick:()=>V(l),children:(0,t.jsx)(w.Z,{className:"w-4 h-4"})})]},l))}),s.length<10&&(0,t.jsxs)(h,{variant:"outline",onClick:()=>{s.length<10&&r([...s,""])},className:"w-full mt-2",children:[(0,t.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Add Player"]})]}),(0,t.jsx)("div",{className:"panda-card bg-secondary/20",children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("strong",{children:"Pink Dice Count:"})," ",Z," pink dice",(0,t.jsx)("br",{}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"Redistributed each round to lowest scoring players"})]})}),(0,t.jsx)(h,{onClick:()=>{let e=s.filter(e=>e.trim());if(e.length<2){alert("Need at least 2 players to start a game");return}if([...new Set(e)].length!==e.length){alert("All player names must be unique");return}n(function(e){let l=e.map((e,l)=>({id:`player_${l+1}`,name:e.trim(),totalScore:0,pandaTokens:0,diceCollection:{yellow:1,purple:0,blue:0,blueGlitter:0,red:0,green:0,clear:0,pink:0},yellowScoreThisRound:0,hasPandaToken:0===l})),s={yellow:9,purple:14,blue:25,blueGlitter:7,red:19,green:10,clear:7,pink:0};s.yellow=Math.max(0,s.yellow-e.length+1);let t={id:`game_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,currentRound:1,status:"PLAYING",phase:"ROLLING",pityDiceCount:R(l.length),createdAt:new Date,players:l,roundScores:[],diceBag:s,availableDicePool:[],pandaTokenHolder:l[0]?.id||null};return L(t),t}(e)),l("PLAYING")},disabled:s.filter(e=>e.trim()).length<2,className:"w-full",children:"Start Game"})]})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{children:(0,t.jsx)(o,{children:"Enhanced Game Features"})}),(0,t.jsx)(u,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"End-of-Round Phases:"}),(0,t.jsxs)("ul",{className:"space-y-1 text-muted-foreground",children:[(0,t.jsxs)("li",{children:["\uD83C\uDFB2 ",(0,t.jsx)("strong",{children:"Roll & Score:"})," Enter dice results"]}),(0,t.jsxs)("li",{children:["\uD83C\uDF38 ",(0,t.jsx)("strong",{children:"Pink Dice:"})," Auto-redistribute to lowest scores"]}),(0,t.jsxs)("li",{children:["\uD83D\uDD04 ",(0,t.jsx)("strong",{children:"Trading:"})," Trade clear dice for others"]}),(0,t.jsxs)("li",{children:["\uD83C\uDFAF ",(0,t.jsx)("strong",{children:"New Dice:"})," Select from bag by yellow score order"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Dice Collection Management:"}),(0,t.jsxs)("ul",{className:"space-y-1 text-muted-foreground",children:[(0,t.jsx)("li",{children:"\uD83D\uDCE6 Track individual dice collections"}),(0,t.jsx)("li",{children:"\uD83D\uDC3C Panda token for highest yellow scores"}),(0,t.jsx)("li",{children:"\uD83D\uDC8E Easy dice count adjustments"}),(0,t.jsx)("li",{children:"\uD83C\uDFAA Visual dice type indicators"})]})]})]})})]})]})})});if(!i)return null;let K=[...i.players].sort((e,l)=>l.totalScore!==e.totalScore?l.totalScore-e.totalScore:l.pandaTokens-e.pandaTokens),q=Y(i),J=i.players.every(e=>F(i,e.id)),Q=i.players.find(e=>e.hasPandaToken);return(0,t.jsx)("div",{className:"min-h-screen purple-gradient-pattern",children:(0,t.jsxs)("div",{className:"container-panda py-6",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-primary flex items-center gap-2",children:"\uD83D\uDC3C Panda Royale"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:function(e){switch(e.status){case"SETUP":return"Setting up game...";case"PLAYING":return`Round ${e.currentRound} of 10 - ${function(e){switch(e){case"SETUP":return"Setting up game...";case"ROLLING":return"Roll dice and enter scores";case"PITY_DICE":return"Redistributing pink pity dice";case"TRADING":return"Trade dice using clear dice";case"NEW_DICE":return"Select new dice from bag";case"RESULTS":return"Round complete - view results";case"GAME_COMPLETE":return"Game finished!";default:return"Unknown phase"}}(e.phase)}`;case"FINISHED":return"Game Complete!";default:return"Unknown status"}}(i)})]}),(0,t.jsxs)(h,{variant:"outline",onClick:W,children:[(0,t.jsx)(E.Z,{className:"w-4 h-4 mr-2"}),"Reset Game"]})]}),"GAME_COMPLETE"!==i.phase&&(0,t.jsx)(ej,{game:i,onAdvancePhase:e=>{if(i)try{let s={...i};switch(e){case"PITY_DICE":s=function(e){let l=e.currentRound-1,s=e.roundScores[l]||[];if(s.length!==e.players.length)throw Error("Cannot redistribute pink dice until all players have submitted scores");let t={...e};t.players=e.players.map(e=>({...e,diceCollection:{...e.diceCollection,pink:0}}));let a=s.map(e=>({playerId:e.playerId,playerName:e.playerName,roundScore:e.roundTotal})).sort((e,l)=>e.roundScore-l.roundScore),r=e.pityDiceCount,i=0,n=0;for(;i<r&&n<a.length;){let l=a[n].roundScore,s=a.filter(e=>e.roundScore===l),c=r-i;if(s.length<=c)for(let e of s){let l=t.players.find(l=>l.id===e.playerId);l&&0===l.diceCollection.pink&&(l.diceCollection.pink=1,i++)}else{let l=e.pandaTokenHolder,a=t.players.findIndex(e=>e.id===l);if(-1!==a){let e=[];for(let l=1;l<=t.players.length;l++){let s=(a+l)%t.players.length;e.push(t.players[s])}for(let l of e){if(i>=r)break;s.some(e=>e.playerId===l.id)&&0===l.diceCollection.pink&&(l.diceCollection.pink=1,i++)}}}if(-1===(n=a.findIndex(e=>e.roundScore>l)))break}return t}(s),s=function(e){let l=e.currentRound-1,s=e.roundScores[l]||[];if(s.length!==e.players.length)throw Error("Cannot update panda token until all players have submitted scores");return function(e,l){let s={...e,pandaTokenHolder:l,players:e.players.map(e=>({...e,hasPandaToken:e.id===l}))};return L(s),s}(e,function(e){if(0===e.length)return null;let l=Math.max(...e.map(e=>e.yellowScore)),s=e.filter(e=>e.yellowScore===l);return s[0]?.playerId||null}(s.map(e=>({playerId:e.playerId,yellowScore:e.yellowScore}))))}(s);break;case"TRADING":let t=s.players.find(e=>e.hasPandaToken);if(t){let e=(s.players.findIndex(e=>e.id===t.id)+1)%s.players.length;I(s.players[e]?.id||"")}break;case"NEW_DICE":let a=Y(s).sort((e,l)=>l.yellowScore-e.yellowScore);a.length>0&&O(a[0]?.playerId||"");break;case"RESULTS":let r=s.currentRound-1,c=s.roundScores[r]||[];s.players=s.players.map(e=>{let l=c.find(l=>l.playerId===e.id);return{...e,totalScore:e.totalScore+(l?.roundTotal||0)}});break;case"ROLLING":s.currentRound>=10?(s.status="FINISHED",s.phase="GAME_COMPLETE",l("FINISHED")):s=function(e){let l={...e,currentRound:e.currentRound+1,phase:"ROLLING",availableDicePool:[],players:e.players.map(e=>({...e,yellowScoreThisRound:0}))};return L(l),l}(s);break;case"GAME_COMPLETE":s.status="FINISHED",l("FINISHED")}"ROLLING"!==e&&(s=function(e,l){let s={...e,phase:l};return L(s),s}(s,e)),n(s)}catch(e){alert(e instanceof Error?e.message:"Failed to advance phase")}},canAdvance:(()=>{switch(i.phase){case"ROLLING":return J;case"PITY_DICE":case"TRADING":case"NEW_DICE":case"RESULTS":return!0;default:return!1}})()}),Q&&(0,t.jsx)(c,{className:"bg-yellow-50 border-yellow-200",children:(0,t.jsx)(u,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,t.jsx)(C.Z,{className:"h-6 w-6 text-yellow-600"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"font-semibold text-yellow-800",children:[Q.name," holds the Panda Token! \uD83D\uDC3C"]}),(0,t.jsxs)("div",{className:"text-sm text-yellow-600",children:[Q.pandaTokens," token",1!==Q.pandaTokens?"s":""," earned"]})]})]})})}),"ROLLING"===i.phase&&(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{children:(0,t.jsx)(o,{children:"Enter Player Scores"})}),(0,t.jsx)(u,{children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:i.players.map(e=>{let l=F(i,e.id);return(0,t.jsxs)(h,{variant:l?"secondary":"outline",onClick:()=>z(e),disabled:l,className:"h-auto py-4 flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-sm font-semibold",children:e.name.charAt(0).toUpperCase()}),(0,t.jsx)("span",{className:"text-sm font-medium truncate",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,t.jsx)(S.Z,{className:"w-3 h-3"}),l?"✓ Done":"Enter Scores"]})]},e.id)})})})]}),"PITY_DICE"===i.phase&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Dice Collections"}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:i.players.map(e=>(0,t.jsx)(et,{player:e,onUpdateDiceCount:H,showControls:!0},e.id))})]}),"TRADING"===i.phase&&(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Player Dice Collections"}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:i.players.map(e=>(0,t.jsx)(et,{player:e,onUpdateDiceCount:H,showControls:!1},e.id))})]}),(0,t.jsx)("div",{children:(0,t.jsx)(ed,{players:i.players,currentPlayerId:D||i.players[0]?.id||"",onExecuteTrade:(e,l,s)=>{if(i)try{let t=function(e,l,s,t){let a=e.players.find(e=>e.id===l),r=e.players.find(e=>e.id===s);if(!a||!r)throw Error("Player not found");let i=A(a,r,t);if(!i.canTrade)throw Error(i.error);let n=U(U(a,"CLEAR",a.diceCollection.clear-1),t,_(a,t)+1),c=U(U(r,t,_(r,t)-1),"CLEAR",r.diceCollection.clear+1),d={...e,players:e.players.map(e=>e.id===l?n:e.id===s?c:e)};return L(d),d}(i,e,l,s);n(t)}catch(e){alert(e instanceof Error?e.message:"Failed to execute trade")}}})})]})}),"NEW_DICE"===i.phase&&(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Player Dice Collections"}),(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:i.players.map(e=>(0,t.jsx)(et,{player:e,onUpdateDiceCount:H,showControls:!1},e.id))})]}),(0,t.jsx)("div",{children:(0,t.jsx)(ep,{diceBag:i.diceBag,players:i.players,currentTurnPlayerId:G,onSelectDie:(e,l,s)=>{if(i)try{let s=function(e,l,s,t){let a=e.players.find(e=>e.id===l);if(!a)throw Error("Player not found");let r=s.toLowerCase().replace("_glitter","Glitter");if(e.diceBag[r]<=0)throw Error(`No ${s} dice available in bag`);let i=U(a,s,_(a,s)+1),n={...e.diceBag};n[r]=Math.max(0,n[r]-1);let c={...e,players:e.players.map(e=>e.id===l?i:e),diceBag:n};return L(c),c}(i,e,l,0),t=Y(s).sort((e,l)=>l.yellowScore-e.yellowScore),a=t.findIndex(l=>l.playerId===e)+1;a<t.length?O(t[a]?.playerId||""):O(""),n(s)}catch(e){alert(e instanceof Error?e.message:"Failed to select die")}}})})]})}),("RESULTS"===i.phase||J&&q.length>0)&&(0,t.jsxs)(c,{children:[(0,t.jsx)(d,{children:(0,t.jsxs)(o,{children:["Round ",i.currentRound," Results"]})}),(0,t.jsx)(u,{children:(0,t.jsx)("div",{className:"space-y-3",children:q.sort((e,l)=>l.roundTotal-e.roundTotal).map((e,l)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-muted-foreground rounded-full flex items-center justify-center text-background text-xs font-bold",children:l+1}),(0,t.jsx)("span",{className:"font-medium",children:e.playerName})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-bold text-primary",children:["+",e.roundTotal]}),e.yellowScore>0&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["\uD83D\uDFE1 ",e.yellowScore]})]})]},e.playerId))})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:B(i)?"Final Results":"Current Standings"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:K.map((e,l)=>(0,t.jsx)(c,{className:0===l?"bg-primary/5 border-primary/30":"",children:(0,t.jsx)(u,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(y,{variant:0===l?"default":"secondary",children:["#",l+1]}),(0,t.jsx)("span",{className:"font-semibold",children:e.name}),e.hasPandaToken&&(0,t.jsx)(y,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"\uD83D\uDC3C"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"font-bold text-lg",children:e.totalScore.toLocaleString()}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.pandaTokens," token",1!==e.pandaTokens?"s":""]})]})]})})},e.id))})]}),B(i)&&(0,t.jsx)(c,{className:"bg-primary/10 border-primary",children:(0,t.jsxs)(u,{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDFC6"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-primary mb-2",children:[$(i.players)?.name," Wins!"]}),(0,t.jsxs)("div",{className:"text-muted-foreground",children:["Final Score: ",$(i.players)?.totalScore.toLocaleString()," points"]}),(0,t.jsxs)(h,{onClick:W,className:"mt-6",children:[(0,t.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Start New Game"]})]})})]}),p&&(0,t.jsx)(el,{open:m,onClose:()=>{x(!1),g(null)},onSubmit:e=>{if(i&&p)try{let l=function(e,l,s){let t=e.currentRound-1;for(;e.roundScores.length<=t;)e.roundScores.push([]);let a=e.players.find(e=>e.id===l);if(!a)throw Error("Player not found");let r=function(e){let l=e.map(P),s=l.filter(e=>"BLUE"===e.diceType);(l.filter(e=>"BLUE_GLITTER"===e.diceType).length>0||e.some(e=>e.hasGlitterDie))&&s.length>0&&s.forEach(e=>{e.multiplier=2,e.finalScore=2*e.rawScore,e.description=`Blue dice with Glitter: (${e.rawScore}) \xd7 2 = ${e.finalScore} points`});let t=l.reduce((e,l)=>e+l.finalScore,0),a=l.find(e=>"YELLOW"===e.diceType)?.finalScore||0;return{totalScore:t,diceScores:l,yellowScore:a}}(s),i={playerId:l,playerName:a.name,diceScores:s,roundTotal:r.totalScore,yellowScore:r.yellowScore};e.roundScores[t]=e.roundScores[t].filter(e=>e.playerId!==l),e.roundScores[t].push(i);let n={...a,yellowScoreThisRound:r.yellowScore},c={...e,players:e.players.map(e=>e.id===l?n:e)};return e.roundScores[t].length===e.players.length&&(c.phase="PITY_DICE"),L(c),c}(i,p.id,e);n(l),x(!1),g(null)}catch(e){alert(e instanceof Error?e.message:"Failed to submit scores")}},player:p})]})})}}},function(e){e.O(0,[178,386,156,744],function(){return e(e.s=8520)}),_N_E=e.O()}]);